# D-PC Client Configuration - Default Settings (v0.10.0)
# This file shows the default configuration generated on first install in ~/.dpc/config.ini
#
# You can override these settings with environment variables using the format:
# DPC_SECTION_KEY (e.g., DPC_HUB_URL, DPC_OAUTH_CALLBACK_PORT, DPC_TURN_USERNAME, etc.)
#
# For complete documentation, see: docs/CONFIGURATION.md

# =============================================================================
# FEDERATION HUB SETTINGS
# =============================================================================
[hub]
# Hub URL for OAuth authentication and WebRTC signaling (optional in v0.10.0+)
# System works without Hub using direct connections, DHT, relays, and gossip
url = http://localhost:8000

# Auto-connect to Hub on startup (true) or start offline (false)
auto_connect = true

# =============================================================================
# OAUTH AUTHENTICATION
# =============================================================================
[oauth]
# OAuth callback server port for receiving authorization codes
callback_port = 8080

# OAuth callback server host (127.0.0.1 for localhost)
callback_host = 127.0.0.1

# Default OAuth provider: 'google' or 'github'
# Used for auto-connect when auto_connect = true
default_provider = google

# =============================================================================
# P2P CONNECTION SETTINGS
# =============================================================================
[p2p]
# TLS server listen port (8888 default)
listen_port = 8888

# Listen host: 'dual' (IPv4+IPv6), '0.0.0.0' (IPv4 only), '::' (IPv6 only)
listen_host = dual

# Connection establishment timeout in seconds
connection_timeout = 30

# =============================================================================
# LOCAL API SERVER (WebSocket for UI)
# =============================================================================
[api]
# WebSocket API server port for frontend communication
port = 9999

# API server host (127.0.0.1 for localhost only)
host = 127.0.0.1

# =============================================================================
# TURN SERVER (for WebRTC fallback)
# =============================================================================
[turn]
# TURN server username (optional, leave empty to use Google STUN only)
username =

# TURN server credential (optional)
credential =

# =============================================================================
# DEVICE CONTEXT COLLECTION
# =============================================================================
[system]
# Auto-collect device/system info for AI context (true recommended)
auto_collect_device_info = true

# Collect hardware tiers (RAM, CPU, disk, GPU) - privacy-rounded values
collect_hardware_specs = true

# Collect installed dev tools and versions (git, docker, node, etc.)
collect_dev_tools = true

# Collect locally available AI models (opt-in for compute-sharing)
# Set to true only if you plan to share compute resources with peers
collect_ai_models = false

# =============================================================================
# DHT PEER DISCOVERY (v0.10.0+)
# =============================================================================
[dht]
# Enable DHT for peer discovery (true recommended)
enabled = true

# UDP port for DHT RPCs (typically TLS port + 1)
port = 8889

# Kademlia k parameter: nodes per bucket (20 standard)
k = 20

# Parallelism factor for iterative lookups (3 standard)
alpha = 3

# Bootstrap timeout in seconds (30s recommended)
bootstrap_timeout = 30

# Lookup timeout in seconds (10s recommended)
lookup_timeout = 10

# Bucket refresh interval in seconds (3600 = 1 hour)
bucket_refresh_interval = 3600

# Re-announce interval in seconds (3600 = 1 hour)
announce_interval = 3600

# Comma-separated list of seed nodes for bootstrapping (ip:port format)
# Leave empty to use local network discovery
seed_nodes =

# =============================================================================
# CONNECTION STRATEGY (6-Tier Fallback Hierarchy) (v0.10.0+)
# =============================================================================
[connection]
# Priority 1: IPv6 Direct (40%+ networks, no NAT, 10s timeout)
enable_ipv6 = true

# Priority 2: IPv4 Direct (local network/port forward, 10s timeout)
enable_ipv4 = true

# Priority 3: Hub WebRTC with STUN/TURN (requires Hub, 30s timeout)
enable_hub_webrtc = true

# Priority 4: DHT-coordinated UDP hole punching (60-70% NAT, 15s timeout)
# ENABLED with DTLS encryption (v0.10.1+)
# Now safe to use - all hole-punched connections are encrypted with DTLS
enable_hole_punching = true

# Priority 5: Volunteer relay nodes (100% NAT coverage, 20s timeout)
enable_relays = true

# Priority 6: Gossip store-and-forward (disaster fallback, eventual delivery)
enable_gossip = true

# Per-strategy timeouts in seconds
ipv6_timeout = 10
ipv4_timeout = 10
webrtc_timeout = 30
hole_punch_timeout = 15
relay_timeout = 20
gossip_timeout = 5

# =============================================================================
# UDP HOLE PUNCHING (Priority 4) (v0.10.0+)
# =============================================================================
[hole_punch]
# UDP port for hole punching
udp_punch_port = 8890

# Enable NAT type detection (cone vs symmetric)
nat_detection_enabled = true

# Endpoint discovery timeout in seconds
stun_timeout = 5

# Number of punch attempts before giving up
punch_attempts = 3

# DTLS ENCRYPTION SETTINGS (v0.10.1+)
# All hole-punched connections are now encrypted with DTLS (Datagram TLS)
enable_dtls = true
dtls_handshake_timeout = 3  # Seconds for DTLS handshake
dtls_version = 1.2  # DTLS protocol version (1.2 or 1.3)

# =============================================================================
# VOLUNTEER RELAY NODES (Priority 5) (v0.10.0+)
# =============================================================================
[relay]
# CLIENT MODE: Use relays for outbound connections
enabled = true

# Preferred geographic region: 'us-west', 'eu-central', 'ap-southeast', 'global'
prefer_region = global

# Relay discovery cache timeout in seconds (300 = 5 minutes)
cache_timeout = 300

# SERVER MODE: Volunteer as relay for others (opt-in)
# Set to true only if you have stable internet and want to help the community
volunteer = false

# Maximum concurrent relay sessions (server mode)
max_peers = 10

# Bandwidth limit for relaying in Mbps (server mode)
bandwidth_limit_mbps = 10.0

# Geographic region for relay announcements (server mode)
region = global

# PRIVACY NOTE: Relays forward encrypted payloads only. They can see:
# - Peer node IDs (who is talking to whom)
# - Message sizes (payload size in bytes)
# - Message timing (when messages are sent)
# Relays CANNOT see: message content, conversation context, personal data

# =============================================================================
# GOSSIP STORE-AND-FORWARD (Priority 6) (v0.10.0+)
# =============================================================================
[gossip]
# Enable gossip protocol for disaster-resilient messaging
enabled = true

# Maximum hops for message forwarding (5 = reasonable reach)
max_hops = 5

# Number of random peers to forward to (3 = epidemic spreading)
fanout = 3

# Message TTL in seconds (86400 = 24 hours)
ttl_seconds = 86400

# Anti-entropy sync interval in seconds (300 = 5 minutes)
# Periodic reconciliation using vector clocks
sync_interval = 300

# Expired message cleanup interval in seconds (600 = 10 minutes)
cleanup_interval = 600

# Default message priority: 'low', 'normal', 'high'
priority = normal

# =============================================================================
# KNOWLEDGE COMMIT SYSTEM (v0.9.0+)
# =============================================================================
[knowledge]
# Warn when context window reaches this threshold (0.8 = 80%)
token_warning_threshold = 0.8

# Automatically suggest knowledge extraction when threshold reached
auto_extraction_enabled = true

# Include cultural perspective analysis in knowledge extraction
# (increases extraction time but improves global context awareness)
cultural_perspectives_enabled = false

# =============================================================================
# FILE TRANSFER SETTINGS (v0.11.0+)
# =============================================================================
[file_transfer]
# Chunk size for file transfers in bytes (65536 = 64KB)
# Smaller chunks = more overhead, larger chunks = less responsive progress
chunk_size = 65536

# Threshold for background transfer in MB (files larger than this transfer in background)
# Background transfers don't block the UI during send/receive
background_threshold_mb = 50

# Threshold for direct TLS preference in MB (files larger than this prefer direct connections)
# Direct TLS is more efficient for large files than WebRTC/relay
direct_tls_only_threshold_mb = 100

# Maximum concurrent file transfers (sending + receiving combined)
max_concurrent_transfers = 3

# Verify file hash after transfer (SHA256)
# Recommended: true (ensures file integrity, minimal performance impact)
verify_hash = true

# =============================================================================
# LOGGING CONFIGURATION
# =============================================================================
[logging]
# Log level: DEBUG, INFO, WARNING, ERROR, CRITICAL
level = INFO

# Enable console output
console = true

# Console log level (can differ from file log level)
console_level = INFO

# Log file path (~ expands to user home directory)
file = ~/.dpc/logs/dpc-client.log

# Maximum bytes per log file before rotation (10485760 = 10MB)
max_bytes = 10485760

# Number of backup log files to keep
backup_count = 5
